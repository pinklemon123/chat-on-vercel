<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AI Chat</title>
<link rel="stylesheet" href="/assets/styles.css" />

<div class="page">
  <div class="glass split">
    <!-- 左侧：提示词库 -->
    <aside id="drawer" class="drawer">
      <div class="drawer-head">
        <h2>提示词库</h2>
        <div class="drawer-actions">
          <button id="newPrompt">新建</button>
          <button id="collapsePrompts" class="only-mobile">收起</button>
        </div>
      </div>

      <div id="promptList" class="prompt-list"></div>

      <div class="prompt-editor" id="editor" data-id="">
        <div class="row"><label>名称</label><input id="pName" /></div>
        <div class="row">
          <label>放入频率</label>
          <select id="pMode">
            <option value="every">每次注入</option>
            <option value="once">仅首次注入</option>
          </select>
        </div>
        <div class="row"><label>系统提示词</label><textarea id="pContent" rows="8"></textarea></div>
        <div class="row"><label>Few-shot（user:/assistant: 一行一条）</label><textarea id="pFewshot" rows="6"></textarea></div>
        <div class="row actions">
          <button id="savePrompt">保存</button>
          <button id="deletePrompt" class="danger">删除</button>
          <button id="setActive">设为当前</button>
        </div>
      </div>
    </aside>

    <!-- 右侧：聊天 -->
    <section class="workspace">
      <header class="bar">
        <h1>AI Chat</h1>
        <div class="toolbar">
          <button id="expandPrompts" class="only-mobile">提示词库</button>
          <label class="switch"><input type="checkbox" id="useSystem" checked /><span>启用系统提示词</span></label>
          <button id="exportPrompts">导出提示词</button>
          <label class="import-btn">导入<input type="file" id="importPrompts" accept="application/json" /></label>
          <button id="clear">清空对话</button>
        </div>
      </header>

      <div id="activeBar" class="active-bar"></div>

      <main id="chat"></main>

      <form id="composer">
        <textarea id="q" rows="3" placeholder="左侧设置提示词，右侧聊天。（Enter 发送，Shift+Enter 换行）"></textarea>
        <button id="send" type="submit">发送</button>
      </form>
    </section>
  </div>
</div>

<script type="module">
  import './js/ui.js';
  import './js/promptlib.js';
  import './js/chat.js';
  import './js/app.js';
</script>

